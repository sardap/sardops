use sdop_game::Note;

pub fn freq(note: &Note) -> f64 {
    const NOTES: &[f64] = &[
        31.0, 33.0, 35.0, 37.0, 39.0, 41.0, 44.0, 46.0, 49.0, 52.0, 55.0, 58.0, 62.0, 65.0, 69.0,
        73.0, 78.0, 82.0, 87.0, 93.0, 98.0, 104.0, 110.0, 117.0, 123.0, 131.0, 139.0, 147.0, 156.0,
        165.0, 175.0, 185.0, 196.0, 208.0, 220.0, 233.0, 247.0, 262.0, 277.0, 294.0, 311.0, 330.0,
        349.0, 370.0, 392.0, 415.0, 440.0, 466.0, 494.0, 523.0, 554.0, 587.0, 622.0, 659.0, 698.0,
        740.0, 784.0, 831.0, 880.0, 932.0, 988.0, 1047.0, 1109.0, 1175.0, 1245.0, 1319.0, 1397.0,
        1480.0, 1568.0, 1661.0, 1760.0, 1865.0, 1976.0, 2093.0, 2217.0, 2349.0, 2489.0, 2637.0,
        2794.0, 2960.0, 3136.0, 3322.0, 3520.0, 3729.0, 3951.0, 4186.0, 4435.0, 4699.0, 4978.0,
        0.0,
    ];

    let index = *note as usize;
    NOTES[index]
}

pub fn get_top(freq_hz: f64, div: f64) -> u16 {
    let sysclk_hz = embassy_rp::clocks::clk_sys_freq() as f64;
    ((sysclk_hz / (div * freq_hz)) - 1.0) as u16
}
